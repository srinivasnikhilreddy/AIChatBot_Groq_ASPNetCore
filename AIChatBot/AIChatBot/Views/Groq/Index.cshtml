@{
    ViewData["Title"] = "AI Chatbot";
}

<!-- CSS -->
<link rel="stylesheet" href="~/css/chatbot.css" />

<h2>AI Chatbot</h2>

<div id="chatContainer" class="chat-container"></div>
<div class="input-area">
    <textarea id="userInput" placeholder="Type your message..."></textarea>
    <button id="submitBtn">Send</button>
</div>

<!-- JS: load marked first -->
<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
<script src="~/js/chatbot.js"></script>


<!-- tightly coupled (html, css, js together) -->
<!--
@{
    ViewData["Title"] = "AI Chatbot";
}

<style>
    body {
        background-color: #343541;
        color: #ececec;
        font-family: Arial, sans-serif;
        padding: 20px;
    }

    h2 {
        color: #ffffff;
    }

    #userInput {
        width: 100%;
        padding: 12px;
        border-radius: 8px;
        border: 1px solid #565869;
        background-color: #40414f;
        color: #ffffff;
        resize: none;
        font-size: 14px;
        margin-bottom: 10px;
    }

    #sendBtn {
        background-color: #10a37f;
        color: white;
        border: none;
        border-radius: 6px;
        padding: 10px 18px;
        cursor: pointer;
        font-size: 14px;
        font-weight: bold;
        transition: background-color 0.2s ease;
    }

    #sendBtn:hover {
        background-color: #0d8f6e;
    }

    #responseBox {
        background-color: #40414f;
        color: #ececec;
        border-radius: 8px;
        padding: 15px;
        margin-top: 15px;
        white-space: pre-wrap;
        line-height: 1.5;
    }
</style>

<h2>AI Chatbot</h2>

<div>
    <textarea id="userInput" rows="4" placeholder="Type your message..."></textarea><br />
    <button id="sendBtn">Send</button>
</div>

<h3>Response:</h3>
<div id="responseBox"></div>

<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
<script>
    document.addEventListener("DOMContentLoaded", () => {
        const sendBtn = document.getElementById("sendBtn");
        const responseBox = document.getElementById("responseBox");
        const userInput = document.getElementById("userInput");

        sendBtn.addEventListener("click", async () => {
            const input = userInput.value.trim();
            if (!input) {
                responseBox.innerHTML = "<i>Please enter a message.</i>";
                return;
            }

            responseBox.innerHTML = "<i>Loading...</i>";

            try {
                const res = await fetch("/Groq/chat", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify(input)
                });

                if (!res.ok) {
                    responseBox.innerText = "❌ Error: " + res.status + " " + res.statusText;
                    return;
                }

                const reader = res.body.getReader();
                const decoder = new TextDecoder();
                let fullText = "";

                while (true) {
                    const { done, value } = await reader.read();
                    if (done) break;

                    fullText += decoder.decode(value, { stream: true });
                    responseBox.innerHTML = marked.parse(fullText);
                }
            } catch (err) {
                responseBox.innerText = "Request failed: " + err.message;
            }
        });
    });
</script>
-->